f93_set_ralis_designs = {
	create_ship_design = { design = "NAME_ralis_corvette_brawl" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_corvette_picket" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_frigate_torpedo" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_frigate_energy" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_destroyer_line" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_destroyer_arty" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_cruiser_carrier" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_battleship_carrier" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_platform_carrier" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_platform_arty" }
	add_ship_design = last_created_design
	create_ship_design = { design = "NAME_ralis_citadel" }
	add_ship_design = last_created_design
}
f93_spawn_ralis_defense_platform = {
	fleet = {
		random_list = {
			1 = {
				owner = {
					random_owned_design = {
						limit = {
							is_ship_size = military_station_small
							has_role = carrier
						}
						save_event_target_as = target_platform
					}
				}
			}
			1 = {
				owner = {
					random_owned_design = {
						limit = {
							is_ship_size = military_station_small
							has_role = artillery
						}
						save_event_target_as = target_platform
					}
				}
			}
		}
		create_ship = {
			name = random
			design = event_target:target_platform
			graphical_culture = owner
		}
	}
}
#Fleet 1
f93_create_ralis_fleet = {
	change_variable = { which = f93_fleet_size value = 0.25 }
	random_system_within_border = {
		limit = { is_capital_system = no }
		star = {
			f93_create_fleet_1 = yes
			last_created_fleet = {
				set_location = prev
			}
		}
	}
}
#creates a subject fleet, spawns it in a random place, sends it to Ralis to defend it
f93_create_ralis_subject_fleet_defense = {
	event_target:f93_ralis_subject = {
		change_variable = { which = fleets_Created value = 1 }
	}
	event_target:f93_ralis_country = {
		random_system_within_border = {
			limit = { is_capital_system = no }
			star = {
				f93_create_fleet_1 = yes
				save_event_target_as = f93_fleets_origin
			}
		}
	}
	last_created_fleet = {
		remove_fleet_flag = ralis_fleet_1
		set_fleet_flag = ralis_fleet_defense
		set_location = event_target:f93_fleets_origin
		set_owner = event_target:f93_ralis_subject
		auto_move_to_planet = {
			target = event_target:f93_ralis_planet
			clear_auto_move_on_arrival = yes
			arrival_effect = f93_set_subject_fleets_position
		}
	}
}
#designates random gal cro system as f93_ralis_target
f93_pick_random_gal_cro_system = {
	closest_system = {
		limit = { f93_system_has_ancient_relay = yes NOT = { has_star_flag = f93_recently_visist@prev } }
		set_timed_star_flag = { flag = f93_recently_visist@prev days = 720 }
		if = {
			limit = { exists = space_owner space_owner = { is_country_type = fallen_empire }  }
		}
		else = {
			star = { save_event_target_as = f93_ralis_target }
		}
	}
}
f93_pick_random_gal_cro_system_loop = {
	closest_system = {
		limit = { f93_system_has_ancient_relay = yes NOT = { has_star_flag = f93_recently_visist@prev } }
		set_timed_star_flag = { flag = f93_recently_visist@prev days = 720 }
		star = { save_event_target_as = f93_ralis_target }
	}
	auto_move_to_planet = {
		target = event_target:f93_ralis_target
		clear_auto_move_on_arrival = yes
		arrival_effect = f93_pick_random_gal_cro_system_loop
	}
}
#needs a f93_ralis_target set
f93_create_ralis_subject_fleet_attack_galcro = {
	event_target:f93_ralis_subject = {
		change_variable = { which = fleets_Created value = 1 }
	}
	event_target:f93_ralis_country = {
		random_system_within_border = {
			star = {
				f93_create_fleet_1 = yes
				save_event_target_as = f93_fleets_origin
			}
		}
	}
	last_created_fleet = {
		remove_fleet_flag = ralis_fleet_1
		set_fleet_flag = ralis_fleet_attack_gal_cro
		set_location = event_target:f93_fleets_origin
		set_owner = event_target:f93_ralis_subject
		auto_move_to_planet = {
			target = event_target:f93_ralis_target
			clear_auto_move_on_arrival = yes
			arrival_effect = f93_pick_random_gal_cro_system_loop
		}
	}
}
#needs a f93_ralis_target set
f93_create_ralis_subject_fleet_attack = {
	event_target:f93_ralis_subject = {
		change_variable = { which = fleets_Created value = 1 }
	}
	event_target:f93_ralis_country = {
		random_system_within_border = {
			star = {
				f93_create_fleet_1 = yes
				save_event_target_as = f93_fleets_origin
			}
		}
	}
	last_created_fleet = {
		remove_fleet_flag = ralis_fleet_1
		set_fleet_flag = ralis_fleet_attack
		set_location = event_target:f93_fleets_origin
		set_owner = event_target:f93_ralis_subject
		auto_move_to_planet = {
			target = event_target:f93_ralis_target
			clear_auto_move_on_arrival = yes
		}
	}
}
#needs a f93_ralis_target set
f93_create_ralis_subject_fleet = {
	event_target:f93_ralis_subject = {
		change_variable = { which = fleets_Created value = 1 }
	}
	event_target:f93_ralis_country = {
		random_system_within_border = {
			star = {
				f93_create_fleet_1 = yes
				save_event_target_as = f93_fleets_origin
			}
		}
	}
	last_created_fleet = {
		remove_fleet_flag = ralis_fleet_1
		set_fleet_flag = ralis_fleet_subject
		set_location = event_target:f93_fleets_origin
		set_owner = event_target:f93_ralis_subject
	}
}


f93_set_subject_fleets_position = {
	set_location = {
		target = event_target:f93_ralis_planet
		distance = { min = 50 max = 150 }
		angle = random
	}
}

f93_create_fleet_1 = {
	create_fleet = {
		settings = {
			can_upgrade = yes
			can_change_composition = no
			can_change_leader = yes	
		}
		effect = {
			set_variable = { which = num_ships_original value = 1 }
			set_variable = { which = halfway_passed_midgame value = value:halfway_to_mid_game_year }
			multiply_variable = { which = halfway_passed_midgame value = -1 }
			set_variable = { which = quarterway_passed_midgame value = halfway_passed_midgame }
			divide_variable = { which = quarterway_passed_midgame value = 2 }
			set_fleet_flag = ralis_fleet_1
			set_owner = event_target:f93_ralis_country
			set_timed_fleet_flag = { flag = recently_made days = 1080 }
			while = {
				count = event_target:f93_ralis_country.f93_fleet_size
				while = {
					count = 11 #number of possible corvettes
					random_list = {
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_corvette_brawl
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_corvette_picket
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						2 = {}
					}
				}
				while = {
					count = 7 #number of possible frigates
					random_list = {
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_frigate_torpedo
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_frigate_energy
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						4 = {}
					}
				}
				while = {
					count = 4 #number of possible destroyers
					random_list = {
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_destroyer_line
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						1 = {
							create_ship = {
								name = random
								design = NAME_ralis_destroyer_arty
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						2 = {}
					}
				}
				if = {
					while = {
						count = 1 #number of possible cruiser
						random_list = {
							1 = {
								create_ship = {
									name = random
									design = NAME_ralis_cruiser_carrier
								}
							change_variable = { which = num_ships_original value = 1 }
							}
							10 = {
								modifier = {
									factor = 0
									count_controlled_ship = {
										count > 6
										limit = { is_ship_size = cruiser }
									}
								}
							}
						}
					}
				}
				if = {
					limit = { mid_game_years_passed >= quarterway_passed_midgame }
					while = {
						count = 1 #number of possible battleship
						random_list = {
							1 = {
								create_ship = {
									name = random
									design = NAME_ralis_battleship_carrier
								}
							change_variable = { which = num_ships_original value = 1 }
							}
							10 = {
								modifier = {
									factor = 0
									count_controlled_ship = {
										count > 4
										limit = { is_ship_size = battleship }
									}
								}
							}
						}
					}
				}
			}
			set_variable = { which = num_ships_original_halfed value = num_ships_original }
			divide_variable = { which = num_ships_original_halfed value = 2 }
		}
	}
}