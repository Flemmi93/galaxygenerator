#Corvette
f93_create_corvettes = {
	while = {
		count = 8
		limit = { owner = { has_resource = { type = alloys amount < 1500 } } }
		owner = { add_resource = { alloys = -100 } }
		create_fleet = {
			settings = {
				can_upgrade = yes
				can_change_composition = yes
				can_change_leader = yes	
			}
			effect = {
				create_ship = {
					name = random
					random_existing_design = corvette
				}
			}
		}
	}
}
#frigate
f93_create_frigates = {
	while = {
		count = 6
		limit = { owner = { has_technology = tech_torpedoes_1 has_resource = { type = alloys amount < 1500 } } }
		owner = { add_resource = { alloys = -125 } }
		create_fleet = {
			settings = {
				can_upgrade = yes
				can_change_composition = yes
				can_change_leader = yes	
			}
			effect = {
				create_ship = {
					name = random
					random_existing_design = frigate
				}
			}
		}
	}
}
#destroyer
f93_create_destroyers = {
	while = {
		count = 4
		limit = { owner = { has_technology = tech_destroyers has_resource = { type = alloys amount < 1500 } } }
		owner = { add_resource = { alloys = -200 } }
		create_fleet = {
			settings = {
				can_upgrade = yes
				can_change_composition = yes
				can_change_leader = yes	
			}
			effect = {
				create_ship = {
					name = random
					random_existing_design = destroyer
				}
			}
		}
	}
}

#cruiser
f93_create_cruisers = {
	while = {
		count = 2
		limit = { owner = { has_technology = tech_cruisers has_resource = { type = alloys amount < 1500 } } }
		owner = { add_resource = { alloys = -400 } }
		create_fleet = {
			settings = {
				can_upgrade = yes
				can_change_composition = yes
				can_change_leader = yes	
			}
			effect = {
				create_ship = {
					name = random
					random_existing_design = cruiser
				}
			}
		}
	}
}

#battleship
f93_create_battleship = {
	while = {
		count = 1
		limit = { owner = { has_resource = { type = alloys amount < 1500 } } }
		owner = { add_resource = { alloys = -800 } }
		create_fleet = {
			settings = {
				can_upgrade = yes
				can_change_composition = yes
				can_change_leader = yes	
			}
			effect = {
				create_ship = {
					name = random
					random_existing_design = destroyer
				}
			}
		}
	}
}

#Corvette Fleet
f93_create_corvette_fleet = {
	create_fleet =  {
		settings = {
			can_upgrade = yes
			can_change_composition = no
			can_change_leader = yes	
		}
		effect = {
			while = {
				count = root.f93_fleet_size
				create_ship = {
					name = random
					random_existing_design = corvette
				}
			}
		}
	}
}

#Destroyer Fleet
f93_create_destryoer_fleet = {
	create_fleet =  {
		settings = {
			can_upgrade = yes
			can_change_composition = no
			can_change_leader = yes	
		}
		effect = {
			while = {
				count = root.f93_fleet_size
				while = {
					count = 3
					create_ship = {
						name = random
						random_existing_design = corvette
					}
				}
				while = {
					count = 2
					create_ship = {
						name = random
						random_existing_design = destroyer
					}
				}
			}
		}
	}
}
#Fleet 1
f93_create_ralis_fleet = {
	if = {
		limit = {
			any_owned_fleet = {
				num_ships < num_ships_original_halfed
				has_fleet_flag = ralis_fleet_1
			}
		}
		random_owned_fleet = {
			limit = {
				num_ships < num_ships_original_halfed
				has_fleet_flag = ralis_fleet_1
			}
			owner = { capital_scope = { f93_create_fleet_1 = yes } change_variable = { which = f93_fleet_size value = 0.25 } }
			auto_follow_fleet = last_created_fleet
			remove_fleet_flag = ralis_fleet_1
			limit = { exists = leader }
			leader = { unassign_leader = this last_created_fleet = { assign_leader = this } }
		}
		random_system_within_border = {
				limit = { is_capital_system = no }
				starbase = {
					last_created_fleet = {
						set_location = prev
					}
				}
			}
	}
	capital_scope = { f93_create_fleet_1 = yes }
	change_variable = { which = f93_fleet_size value = 0.25 }
	random_system_within_border = {
		limit = { is_capital_system = no }
		starbase = {
			last_created_fleet = {
				set_location = prev
			}
		}
	}
}
f93_create_fleet_1 = {
	create_fleet =  {
		settings = {
			can_upgrade = yes
			can_change_composition = no
			can_change_leader = yes	
		}
		effect = {
			set_variable = { which = num_ships_original value = 1 }
			owner = { change_variable = { which = f93_fleet_size value = 0.5 } }
			set_variable = { which = emergency_fleet value = root.emergency_fleet }
			set_variable = { which = halfway_passed_midgame value = value:halfway_to_mid_game_year }
			multiply_variable = { which = halfway_passed_midgame value = -1 }
			set_variable = { which = quarterway_passed_midgame value = halfway_passed_midgame }
			divide_variable = { which = quarterway_passed_midgame value = 2 }
			set_fleet_flag = ralis_fleet_1
			set_owner = root
			while = {
				count = root.f93_fleet_size
				while = {
					count = 11 #number of possible corvettes
					random_list = {
						1 = {
							create_ship = {
								name = random
								random_existing_design = corvette
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						1 = {}
					}
				}
				while = {
					count = 7 #number of possible frigates
					random_list = {
						1 = {
							create_ship = {
								name = random
								random_existing_design = frigate
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						2 = {}
					}
				}
				while = {
					count = 4 #number of possible destroyers
					random_list = {
						1 = {
							create_ship = {
								name = random
								random_existing_design = destroyer
							}
							change_variable = { which = num_ships_original value = 1 }
						}
						1 = {}
					}
				}
				if = {
					while = {
						count = 1 #number of possible cruiser
						random_list = {
							1 = {
								create_ship = {
									name = random
									random_existing_design = cruiser
								}
							change_variable = { which = num_ships_original value = 1 }
							}
							10 = {
								modifier = {
									factor = 0
									count_controlled_ship = {
										count > 3
										limit = { is_ship_size = battleship }
									}
								}
							}
						}
					}
				}
				if = {
					limit = { mid_game_years_passed >= quarterway_passed_midgame }
					while = {
						count = 1 #number of possible battleship
						random_list = {
							1 = {
								create_ship = {
									name = random
									random_existing_design = battleship
								}
							change_variable = { which = num_ships_original value = 1 }
							}
							10 = {
								modifier = {
									factor = 0
									count_controlled_ship = {
										count > 2
										limit = { is_ship_size = battleship }
									}
								}
							}
						}
					}
				}
			}
			set_variable = { which = num_ships_original_halfed value = num_ships_original }
			divide_variable = { which = num_ships_original_halfed value = 2 }
		}
	}
}

#Cruiser Fleet crisis
f93_create_crisis_cruiser_fleet = {
	create_fleet =  {
		settings = {
			can_upgrade = yes
			can_change_composition = no
			can_change_leader = yes	
		}
		effect = {
			while = {
				count = root.f93_fleet_size
				while = {
					count = 3
					create_ship = {
						name = random
						random_existing_design = crisis_corvette
					}
				}
				while = {
					count = 1
					create_ship = {
						name = random
						random_existing_design = crisis_frigate
					}
				}
				while = {
					count = 2
					create_ship = {
						name = random
						random_existing_design = crisis_destroyer
					}
				}
				while = {
					count = 3
					create_ship = {
						name = random
						random_existing_design = crisis_cruiser
					}
				}
				while = {
					count = 1
					create_ship = {
						name = random
						random_existing_design = battleship
					}
				}
			}
		}
	}
}