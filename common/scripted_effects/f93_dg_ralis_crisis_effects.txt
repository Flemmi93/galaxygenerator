

create_capital_to_acient_relay_lane = {
	if = {
		limit = {
			exists = event_target:system_capital
			exists = event_target:system_ancient_relay
		}
		save_global_event_target_as = system_last_step
		while = {
			# count = @steps
			limit = {
				NOT = { event_target:system_ancient_relay = { any_neighbor_system = { is_same_value = event_target:system_last_step } } } 
			}
			event_target:system_ancient_relay = {
				closest_system = {
					limit = {
						NOT = { has_star_flag = dd_highway_system_flag }
						or = {
							distance = {
								source = event_target:system_last_step
								max_jumps = 1
								type = hyperlane
							}
						}
					}
					save_global_event_target_as = new_highway_system
					set_star_flag = f93_empire_connects_to_ancient_relay_flag
				}
			}
			clear_global_event_target = new_highway_system

		}
		if = {
			limit = { event_target:system_ancient_relay = { any_neighbor_system = { is_same_value = event_target:system_last_step } } }
			set_star_flag = f93_empire_connects_to_ancient_relay_flag
		}
	}
}